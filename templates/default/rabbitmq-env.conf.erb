###
# Generated by Chef
###

<% if node['rabbitmq']['local_erl_networking'] -%>
NODENAME=rabbit@localhost
NODE_IP_ADDRESS=127.0.0.1
export ERL_EPMD_ADDRESS=127.0.0.1
<% elsif node['rabbitmq']['erl_networking_bind_address'] -%>
NODENAME=<%= node['rabbitmq']['nodename'] %>
NODE_IP_ADDRESS=<%= node['rabbitmq']['erl_networking_bind_address'] %>
export ERL_EPMD_ADDRESS=<%= node['rabbitmq']['erl_networking_bind_address'] %>
<% else -%>
<% if node['rabbitmq']['address'] -%>NODE_IP_ADDRESS=<%= node['rabbitmq']['address'] %><% end %>
<% if node['rabbitmq']['nodename'] -%>NODENAME=<%= node['rabbitmq']['nodename'] %><% end %>
<% end -%>
<% if node['rabbitmq']['port'] -%>NODE_PORT=<%= node['rabbitmq']['port'] %><% end %>
<% if node['rabbitmq']['config'] -%>CONFIG_FILE=<%= node['rabbitmq']['config'] %><% end %>
<% if node['rabbitmq']['logdir'] -%>LOG_BASE=<%= node['rabbitmq']['logdir'] %><% end %>
<% if node['rabbitmq']['mnesiadir'] -%>MNESIA_BASE=<%= node['rabbitmq']['mnesiadir'] %><% end %>

<% if node['rabbitmq']['open_file_limit'] -%>ulimit -n <%= node['rabbitmq']['open_file_limit'] %><% end %>

<% if node[:rabbitmq][:inet_dist_listen_min] && node[:rabbitmq][:inet_dist_listen_max] %>
# Set the min/max ports used for Erlang distributed node protocol.
# See http://www.rabbitmq.com/clustering.html#firewall
SERVER_ERL_ARGS="$SERVER_ERL_ARGS -kernel inet_dist_listen_min <%= node[:rabbitmq][:inet_dist_listen_min] -%> -kernel inet_dist_listen_max <%= node[:rabbitmq][:inet_dist_listen_max] -%>"
<% end %>
